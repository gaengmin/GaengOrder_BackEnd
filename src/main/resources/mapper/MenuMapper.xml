<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="tableOrder.menu.mapper.MenuMapper">
    <!-- 다중 메뉴 배치할 때, 쿼리
    MyBatis의 <foreach>에서 separator=";"는 각 반복문에서 생성되는 SQL 문장 사이에 세미콜론(;)을 넣어준다는 의미-->

    <update id = "updateMenuForEachOrder">
        <foreach collection="positions" item="item" separator=";">
            UPDATE MENU
            SET position = #{item.position}
            WHERE menu_no = #{item.menuNo}
        </foreach>

    </update>
    
    
    <!-- FUNCTION : 상태 변화 쿼리-->
    <update id="updateMenuStatus" parameterType="long">
        UPDATE MENU
        set menu_status =
                CASE
                    WHEN menu_status = 'Y' THEN 'N'
                    ELSE 'Y'
                    END
        WHERE menu_no = #{menuNo}
          and soft_delete = 'N'
    </update>

    <update id="updateMenuData" parameterType="map">
        UPDATE MENU
        <set>
            <if test="dto.menuName != null">
                menu_name = #{dto.menuName},
            </if>
            <if test="dto.menuPrice != null">
                menu_price = #{dto.menuPrice},
            </if>
            <if test="dto.categoriesNo != null">
                categories_no = #{dto.categoriesNo},
            </if>
            <if test="dto.description != null">
                description = #{dto.description},
            </if>
        </set>
        WHERE menu_no = #{menuNo}
    </update>

</mapper>